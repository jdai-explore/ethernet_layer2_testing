# TC8 Layer 2 v3.0 — Section 5.5 Address Learning Specifications (Representative Set)
# Data-driven definitions — first 10 of 21 specs shown

SWITCH_ADDR_001:
  tc8_reference: "5.5.1"
  title: "Source MAC Learning"
  description: "Verify switch learns source MAC address and associates it with the ingress port"
  priority: high
  parameters:
    vid_range: [1, 100]
  preconditions:
    - "MAC address table cleared"
  test_procedure:
    - "Send frame with unique source MAC on port X"
    - "Send frame with that MAC as destination on another port"
    - "Verify frame forwarded only to port X (unicast, not flooded)"
  expected_result:
    forward_to: "learned_port"
    strict_forwarding: true

SWITCH_ADDR_002:
  tc8_reference: "5.5.2"
  title: "MAC Learning — Multiple Ports"
  description: "Verify switch maintains MAC-to-port bindings for multiple addresses across different ports"
  priority: high
  parameters:
    vid_range: [1, 100]
    mac_count: 10
  preconditions:
    - "MAC address table cleared"
  test_procedure:
    - "Learn different MAC addresses on each port"
    - "Send frames to each learned MAC"
    - "Verify each frame goes to correct port"
  expected_result:
    forward_to: "learned_port"

SWITCH_ADDR_003:
  tc8_reference: "5.5.3"
  title: "MAC Learning — Port Migration"
  description: "Verify switch updates MAC entry when a host moves to a different port"
  priority: high
  parameters:
    vid_range: [1, 100]
  preconditions:
    - "MAC address learned on port A"
  test_procedure:
    - "Learn MAC on port A"
    - "Send frame with same source MAC on port B"
    - "Verify MAC entry updated to port B"
    - "Send frame to that MAC — verify forwarded to port B"
  expected_result:
    forward_to: "learned_port"
    port_migration: true

SWITCH_ADDR_004:
  tc8_reference: "5.5.4"
  title: "Unknown Destination Flooding"
  description: "Verify frames with unknown destination MAC are flooded to all ports in VLAN"
  priority: high
  parameters:
    vid_range: [1, 100]
  preconditions:
    - "MAC address table cleared or destination MAC not learned"
  test_procedure:
    - "Send frame with unknown destination MAC"
    - "Verify frame flooded to all VLAN member ports"
  expected_result:
    forward_to: "member_ports_only"

SWITCH_ADDR_005:
  tc8_reference: "5.5.5"
  title: "MAC Table Capacity"
  description: "Verify switch handles MAC table at capacity — new entries either replace oldest or cause flooding"
  priority: medium
  parameters:
    mac_count_range: [1, 2048]
  preconditions:
    - "MAC address table cleared"
  test_procedure:
    - "Learn MAC addresses until table capacity reached"
    - "Attempt to learn one more MAC"
    - "Verify behavior (replace oldest or flood)"
  expected_result:
    behavior: "implementation_defined"

SWITCH_ADDR_006:
  tc8_reference: "5.5.6"
  title: "MAC Aging — Entry Timeout"
  description: "Verify learned MAC entries age out after the configured aging time"
  priority: high
  timing_tier: tier_b
  parameters:
    vid_range: [1, 100]
  preconditions:
    - "MAC aging time known (from DUT profile)"
  test_procedure:
    - "Learn MAC on port X"
    - "Wait for aging timeout"
    - "Send frame to that MAC"
    - "Verify frame is flooded (entry aged out)"
  expected_result:
    forward_to: "member_ports_only"
    entry_aged: true

SWITCH_ADDR_007:
  tc8_reference: "5.5.7"
  title: "MAC Aging — Refresh on Activity"
  description: "Verify MAC aging timer resets when traffic is received from the learned source"
  priority: high
  timing_tier: tier_b
  parameters:
    vid_range: [1, 100]
  preconditions:
    - "MAC aging time known"
  test_procedure:
    - "Learn MAC on port X"
    - "Wait for 80% of aging time"
    - "Send another frame from same source MAC on port X"
    - "Wait for 80% of aging time again"
    - "Send frame to that MAC — verify unicast (timer was refreshed)"
  expected_result:
    forward_to: "learned_port"
    entry_refreshed: true

SWITCH_ADDR_008:
  tc8_reference: "5.5.8"
  title: "Static MAC Entry"
  description: "Verify statically configured MAC entries are not subject to aging"
  priority: medium
  parameters:
    vid_range: [1, 100]
  preconditions:
    - "DUT supports static MAC entries"
    - "Static MAC configured on DUT"
  test_procedure:
    - "Configure static MAC entry for port X"
    - "Wait for aging timeout"
    - "Send frame to that MAC — verify still forwarded to port X"
  expected_result:
    forward_to: "learned_port"
    no_aging: true

SWITCH_ADDR_009:
  tc8_reference: "5.5.9"
  title: "Broadcast Source MAC"
  description: "Verify switch does not learn broadcast MAC as source address"
  priority: medium
  parameters: {}
  test_procedure:
    - "Send frame with source MAC = FF:FF:FF:FF:FF:FF"
    - "Verify switch does not create MAC table entry for broadcast address"
  expected_result:
    no_learning: true

SWITCH_ADDR_010:
  tc8_reference: "5.5.10"
  title: "Multicast Source MAC"
  description: "Verify switch does not learn multicast MAC addresses as source"
  priority: medium
  parameters: {}
  test_procedure:
    - "Send frame with multicast source MAC (bit 0 of first octet = 1)"
    - "Verify switch does not learn this address"
  expected_result:
    no_learning: true

SWITCH_ADDR_011:
  tc8_reference: "5.5.11"
  title: "Per-VLAN MAC Learning (IVL)"
  description: "Verify MAC address learning is independent per VLAN (Independent VLAN Learning)"
  priority: high
  parameters:
    vid_range: [1, 100]
  test_procedure:
    - "Learn MAC-X on Port A in VLAN 10"
    - "Send frame to MAC-X in VLAN 20 from Port B"
    - "Verify frame is flooded in VLAN 20 (separate learning context)"
  expected_result:
    forward_to: "member_ports_only"
    per_vlan_learning: true

SWITCH_ADDR_012:
  tc8_reference: "5.5.12"
  title: "MAC Learning Rate"
  description: "Verify switch can learn new MAC addresses at the expected rate"
  priority: medium
  parameters:
    mac_count: 100
    rate_pps: 1000
  test_procedure:
    - "Send frames with unique source MACs at specified rate"
    - "Verify all MACs are learned without loss"
  expected_result:
    all_macs_learned: true

SWITCH_ADDR_013:
  tc8_reference: "5.5.13"
  title: "Per-VLAN Aging Timer"
  description: "Verify MAC aging operates independently for each VLAN"
  priority: medium
  timing_tier: tier_b
  parameters:
    vid_range: [1, 100]
  test_procedure:
    - "Learn MAC in VLAN 10 and VLAN 20"
    - "Refresh MAC in VLAN 10 only"
    - "Wait for aging timeout"
    - "Verify VLAN 20 entry aged, VLAN 10 entry retained"
  expected_result:
    per_vlan_aging: true

SWITCH_ADDR_014:
  tc8_reference: "5.5.14"
  title: "Rapid MAC Move Detection"
  description: "Verify switch detects and handles rapid MAC address moves between ports"
  priority: medium
  parameters:
    move_count: 10
    interval_ms: 100
  test_procedure:
    - "Learn MAC on Port A"
    - "Rapidly send frames with same source MAC from Port B"
    - "Verify MAC entry updates to Port B"
  expected_result:
    port_migration: true

SWITCH_ADDR_015:
  tc8_reference: "5.5.15"
  title: "MAC Table Overflow Behavior"
  description: "Verify switch behavior when MAC table is full and new MAC is received"
  priority: medium
  parameters:
    mac_count_range: [1, 4096]
  test_procedure:
    - "Fill MAC table to capacity"
    - "Send frame with new source MAC"
    - "Verify either oldest entry replaced or new frame flooded"
  expected_result:
    behavior: "implementation_defined"

SWITCH_ADDR_016:
  tc8_reference: "5.5.16"
  title: "Static vs. Dynamic Entry Priority"
  description: "Verify static MAC entries cannot be overwritten by dynamically learned entries"
  priority: medium
  parameters:
    vid_range: [1, 100]
  test_procedure:
    - "Configure static MAC entry for Port A"
    - "Send frame with same source MAC on Port B"
    - "Verify static entry unchanged — traffic still goes to Port A"
  expected_result:
    static_priority: true

SWITCH_ADDR_017:
  tc8_reference: "5.5.17"
  title: "MAC Flush on Link Down"
  description: "Verify learned MAC entries for a port are flushed when link goes down"
  priority: medium
  test_procedure:
    - "Learn MACs on Port A"
    - "Disconnect Port A (link down)"
    - "Send frame to learned MAC — verify flooding (entry flushed)"
  expected_result:
    entries_flushed: true

SWITCH_ADDR_018:
  tc8_reference: "5.5.18"
  title: "MAC Flush on Topology Change"
  description: "Verify MAC table flushed on spanning tree topology change notification"
  priority: low
  test_procedure:
    - "Learn MACs across multiple ports"
    - "Trigger topology change"
    - "Verify MAC table cleared"
  expected_result:
    entries_flushed: true

SWITCH_ADDR_019:
  tc8_reference: "5.5.19"
  title: "Learning Disabled on Port"
  description: "Verify MAC learning can be disabled on specific ports"
  priority: low
  parameters:
    vid_range: [1, 100]
  preconditions:
    - "Learning disabled on test port"
  test_procedure:
    - "Send frame with new source MAC on learning-disabled port"
    - "Verify MAC is NOT added to table"
  expected_result:
    no_learning: true

SWITCH_ADDR_020:
  tc8_reference: "5.5.20"
  title: "Multiple MACs Per Port"
  description: "Verify switch correctly handles multiple MAC addresses learned on the same port"
  priority: medium
  parameters:
    mac_count: 10
  test_procedure:
    - "Send frames with 10 different source MACs on same port"
    - "Verify all 10 MACs learned and associated with that port"
  expected_result:
    all_macs_learned: true

SWITCH_ADDR_021:
  tc8_reference: "5.5.21"
  title: "Aging Timer Accuracy"
  description: "Verify MAC aging timer expires within acceptable tolerance of configured value"
  priority: medium
  timing_tier: tier_b
  parameters:
    aging_tolerance_percent: 10
  test_procedure:
    - "Learn MAC on port"
    - "Measure time until entry ages out"
    - "Verify within ±10% of configured aging time"
  expected_result:
    aging_accurate: true
